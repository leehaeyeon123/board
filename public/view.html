<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>글 상세</title>
</head>
<body>
  <h1 id="title"></h1>
  <div id="content"></div>

  <a href="/">목록으로</a>
  <!-- ✨ 삭제 버튼 추가 -->
  <button id="delete-btn">삭제</button>
  <!-- ✨ 수정 버튼 추가 -->
  <button id="edit-btn">수정</button>

  <script>
    const id = location.pathname.split('/').pop();

    // 글 불러오기
    async function loadPost() {
      try {
        const res = await fetch(`/api/posts/${id}`);
        if (!res.ok) throw new Error('글을 찾을 수 없습니다.');
        const post = await res.json();
        document.getElementById('title').textContent = post.title;
        document.getElementById('content').textContent = post.content;
      } catch (err) {
        alert(err.message);
        window.location.href = '/';
      }
    }

    // 삭제 요청 보내기
    async function deletePost() {
      const confirmDelete = confirm('정말 삭제하시겠습니까?');
      if (!confirmDelete) return;

      try {
        const res = await fetch(`/api/posts/${id}`, {
          method: 'DELETE'
        });
        const result = await res.json();
        alert(result.message);
        window.location.href = '/';
      } catch (err) {
        alert('삭제 중 오류가 발생했습니다.');
      }
    }

    // 수정 버튼 클릭 시 edit 페이지로 이동
    function editPost() {
      window.location.href = `/edit/${id}`;
    }

    // 이벤트 등록
    document.getElementById('delete-btn').addEventListener('click', deletePost);
    document.getElementById('edit-btn').addEventListener('click', editPost);

    // 글 로딩 시작
    loadPost();
  </script>
</body>
</html>
